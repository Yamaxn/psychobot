<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychobot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <!-- Include the navbar directly -->
    {% include 'navbar.html' %}

    <!-- Side Menu -->
    <aside class="side-menu">
        <div class="top">
            <ul>
                <li><a href="#" id="newChatBtn" class="create-chat">+ New Chat</a></li>
                <li><a href="#">History</a></li>
            </ul>
        </div>
        <div class="bot">
            <ul>
                <li><a href="#">Upgrade+</a></li>
                <li><a href="{{ url_for('terms') }}">Terms & Conditions</a></li>
            </ul>
        </div>
    </aside>

    <!-- Chatbot Section -->
    <section class="chatbot">
        <div class="chat-container">
            <div class="chat-header">
                <h2>Welcome to Psychobot</h2>
                <p>Chat with our AI Psychologist</p>
            </div>
            <div class="chat-log" id="chatLog">
                <!-- Chat messages will be displayed here -->
            </div>
            <div class="chat-input">
                <input type="text" id="messageInput" placeholder="Message Psychobot...">
                <button id="sendButton">Send</button>
            </div>
        </div>
    </section>

    <!-- Include jQuery library -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        // Function to clear the chat log
        function clearChat() {
            $('#chatLog').empty(); // Remove all content from the chat log
        }
    
        // Event listener for the "+ New Chat" button
        $('#newChatBtn').click(function() {
            clearChat(); // Call the clearChat function when the button is clicked
        });
    
        // Function to send a message to the backend and display the response
        function sendMessage() {
            // Get the message from the input field
            var message = $('#messageInput').val();
    
            // Clear the input field
            $('#messageInput').val('');
    
            // Send a POST request to the backend
            $.ajax({
                url: '/send_message',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ message: message }),
                success: function(response) {
                    // Append the response to the chat log
                    $('#chatLog').append('<p>User: ' + message + '</p>');
                    $('#chatLog').append('<p>Psychobot: ' + response.response + '</p>');
                }
            });
        }
    
        // Event listener for the send button
        $('#sendButton').click(function() {
            sendMessage();
        });
    
        // Event listener for pressing Enter key
        $('#messageInput').keypress(function(event) {
            if (event.which == 13) {
                sendMessage();
            }
        });
    </script>
    

</body>

</html>